<p-dialog
  [visible]="visible"
  header="Investir dans {{ scpiName }}"
  [(visible)]="visible"
  modal="true"
  (onHide)="closeModal()"
  class="custom-dialog"
  [style]="{ width: '50vw' }"
  [draggable]="false"
  [modal]="true"
  [dismissableMask]="true"
>
  <div class="scpi-info-container sub-header">
    <span class="scpi-info"> {{ location }}</span>
    <span class="scpi-info"> {{ distributionRate }}</span>
    <span class="scpi-info"> {{ minimumSubscription }}</span>
  </div>
  <form [formGroup]="investmentForm" style="margin-top: 25px">
    <div class="form-group">
      <label for="propertyType">Type de propriété</label>
      <p-dropdown
        id="propertyType"
        formControlName="propertyType"
        [options]="propertyOptions"
        placeholder="Sélectionnez"
        class="full-width-input"
      >
      </p-dropdown>
      <div
        *ngIf="
          investmentForm.controls['propertyType'].invalid &&
          investmentForm.controls['propertyType'].touched
        "
      >
        <small class="error">Le type de propriété est obligatoire</small>
      </div>
    </div>
    <div
      class="form-group"
      *ngIf="
        investmentForm.value.propertyType === 'Nue propriété' ||
        investmentForm.value.propertyType === 'Usufruit'
      "
    >
      <label for="investmentDuration">Nombre d’années</label>
      <app-year-picker-calendar
        (yearSelected)="onYearSelected($event)"
      ></app-year-picker-calendar>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label for="sharePrice">Prix de la part</label>
        <p-inputNumber
          id="sharePrice"
          formControlName="sharePrice"
          mode="currency"
          currency="EUR"
          class="full-width-input"
        >
        </p-inputNumber>
        <div
          *ngIf="
            investmentForm.controls['sharePrice'].invalid &&
            investmentForm.controls['sharePrice'].touched
          "
        >
          <small class="error">Le montant est obligatoire</small>
        </div>
      </div>

      <div class="form-group">
        <label for="shareCount">Nombre de parts</label>
        <p-inputNumber
          id="shareCount"
          formControlName="shareCount"
          [min]="1"
          [step]="1"
          [disabled]="!editable"
          class="full-width-input"
        >
        </p-inputNumber>

        <div
          *ngIf="
            investmentForm.controls['shareCount'].invalid &&
            investmentForm.controls['shareCount'].touched
          "
        >
          <small class="error">Le nombre de parts est obligatoire</small>
        </div>
      </div>
    </div>
    <div class="form-group">
      <label for="totalInvestment">Montant total à Investir</label>
      <p-inputNumber
        id="totalInvestment"
        formControlName="totalInvestment"
        mode="currency"
        currency="EUR"
        class="full-width-input"
      >
      </p-inputNumber>
      <div
        *ngIf="
          investmentForm.controls['totalInvestment'].invalid &&
          investmentForm.controls['totalInvestment'].touched
        "
      >
        <small class="error">Le montant est obligatoire</small>
      </div>
    </div>
    <div class="investment-info">
      <span class="scpi-info">
        <i class="pi pi-home"></i>
        <strong class="label-green">Type - </strong>
        {{ investmentForm.getRawValue().propertyType }}
      </span>
      <span class="scpi-info">
        <i class="pi pi-dollar"></i>
        <strong class="label-green">Prix de la part - </strong>
        {{ investmentForm.getRawValue().sharePrice }}
      </span>
      <span class="scpi-info">
        <i class="pi pi-calculator"></i>
        <strong class="label-green">Nombre de parts - </strong>
        {{ investmentForm.getRawValue().shareCount }}
      </span>
      <span class="scpi-info">
        <i class="pi pi-chart-line"></i>
        <strong class="label-green">Total - </strong>
        {{ investmentForm.getRawValue().totalInvestment }}
      </span>
    </div>

    <div class="button-group">
      <p-button
        label="Valider"
        severity="info"
        size="large"
        icon="pi pi-check"
        (click)="confirmInvestment()"
        class="special-button"
        [disabled]="!investmentForm.valid"
      >
      </p-button>
    </div>
  </form>
</p-dialog>
